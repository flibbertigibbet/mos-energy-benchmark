!function(){"use strict";function t(t){var e={};return e.strFormat=function(t,e){var r=t;return angular.forEach(e,function(t,e){var a=new RegExp("{"+e+"}","g");r=r.replace(a,t)}),r},e.inViewPort=function(e){var r=t[0].documentElement.clientHeight,a=t[0].documentElement.clientWidth,o=e[0].getBoundingClientRect();return o.top>=0&&o.bottom<=r&&o.left>=0&&o.right<=a},e.onPanelSnap=function(t,e){$(t[0]).parents(".panel-snap-container").on("panelsnap:finish",function(t){e(t)})},e}t.$inject=["$document"],angular.module("mos.utils",[]).factory("Utils",t)}(),function(){"use strict";angular.module("mos.config",[]).constant("MOSTablePrefix","mos_staging_")}(),function(){"use strict";function t(t,e){var r={};return r.user="mos-benchmarking",r.uniqueColumn="cartodb_id",r.yearsTable=e+"years",r.infoTable=e+"info",r.timeIndependentFields=["year_built","floor_area"],r.labels={eui:"EUI (kBtu/ft&sup2;)",emissions:"Emissions (MtCO2e)",energystar:"Energy Star",squarefeet:"Sq. Ft."},r.data={url:"https://"+r.user+".carto.com/api/v2/sql",currAllQuery:t.strFormat("SELECT  address, cartodb_id, number_of_buildings, phl_bldg_id, postal_code, primary_property_type, floor_area, sector, year_built, portfolio_bldg_id, property_name, electricity_{year} as electricity, energy_star_{year} as energy_star, fuel_oil_{year} as fuel_oil, natural_gas_{year} as natural_gas, site_eui_{year} as site_eui, source_eui_{year} as source_eui, steam_{year} as steam, total_ghg_{year} as total_ghg, water_use_{year} as water_use FROM {table}",{}),detailQuery:t.strFormat("SELECT * from {table} where {uniqueColumn} in ({id})",{uniqueColumn:r.uniqueColumn}),groupedQuery:t.strFormat("SELECT  sector as name, count(*) as count, sum(site_eui_{year}) as eui, avg(energy_star_{year}) as energystar, sum(total_ghg_{year}) as emissions, sum(site_eui_{year} * floor_area) as totalenergy FROM {table} GROUP BY sector",{}),yearsQuery:t.strFormat("SELECT * from {table} ORDER BY year DESC",{table:r.yearsTable}),infoQuery:t.strFormat("SELECT * from {table}",{table:r.infoTable})},r}t.$inject=["Utils","MOSTablePrefix"],angular.module("mos.cartodb",["mos.utils","mos.config"]).factory("CartoConfig",t)}(),function(){"use strict";function t(t,e,r,a,o,n){function i(e,r){r=r||{};var o=n.strFormat(e,r);return t.get(a.data.url,{params:{q:o},cache:!0})}function l(){var t=parseInt(e.search().year,10);return c.years.indexOf(t)>=0?t:c.years[0]}function s(){return o+"beb_"+c.years.slice().sort().join("_")}var c={},u={};return c.years=[],c.allYears=[],c.getCurrentYear=l,c.getTableName=s,c.yearsData=function(){return u},c.getCurrentData=function(t){var e=[];return angular.forEach(t,function(t){var r={id:t.portfolio_bldg_id,sector:t.sector,propertyname:t.property_name,emissions:t.total_ghg,energystar:t.energy_star,eui:t.site_eui,sqfeet:t.floor_area,yearbuilt:t.year_built};e.push(r)}),e},c.getInfo=function(t){var e={};return angular.forEach(t,function(t){e[t.key]=t.value}),e},c.getAllCurrentData=function(){return i(a.data.currAllQuery,{year:l(),table:s()})},c.getGroupedData=function(){return i(a.data.groupedQuery,{year:l(),table:s()})},c.getBuildingData=function(t){var e=t;return _.isArray(t)&&(e=t.join(",")),i(a.data.detailQuery,{id:e,table:s()})},c.getInfoData=function(){return i(a.data.infoQuery)},c.getYearsData=function(){return i(a.data.yearsQuery)},c.setYears=function(t){var e=[];angular.forEach(t.data.rows,function(t){e.push(t.year),u[t.year]={downloadUrl:t.download_url,avgEnergyStar:t.avg_energy_star,ghgBuildings:t.ghg_buildings,numBuildings:t.num_buildings}}),c.allYears=e,e.length>=3&&(c.years=e.slice(0,3)),r.$broadcast("mos.cartodb:years",c.years)},c}t.$inject=["$http","$location","$rootScope","CartoConfig","MOSTablePrefix","Utils"],angular.module("mos.cartodb").factory("CartoSQLAPI",t)}(),function(){"use strict";function t(t){return function(e,r){return e=parseFloat(e),isNaN(e)?"N/A":t("number")(e,r)}}t.$inject=["$filter"],angular.module("mos.cartodb").filter("cartodbNumber",t)}(),function(){"use strict";function t(t){t.state("root",{abstract:!0,controller:"RootController",templateUrl:"scripts/root/root-partial.html",resolve:{yearData:["CartoSQLAPI",function(t){return t.getYearsData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.root",["ui.router","mos.cartodb","mos.headerbar","mos.utils"]).config(t)}(),function(){"use strict";function t(t,e){t.setYears(e)}t.$inject=["CartoSQLAPI","yearData"],angular.module("mos.root").controller("RootController",t)}(),function(){"use strict";angular.module("mos.headerbar",["ui.router","mos.cartodb","mos.years"])}(),function(){"use strict";function t(t){this.getYear=t.getCurrentYear}t.$inject=["CartoSQLAPI"],angular.module("mos.headerbar").controller("HeaderBarController",t)}(),function(){"use strict";angular.module("mos.headerbar").directive("mosHeaderbar",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/headerbar/headerbar-partial.html",bindToController:!0,controller:"HeaderBarController",controllerAs:"ctl"}})}(),function(){"use strict";angular.module("mos.colors",["mos.cartodb"])}(),function(){"use strict";function t(t,e,r,a){function o(t,e){return t.name.localeCompare(e.name)}var n={};n.getColorByFields=function(){var t={sector:"Building Type"};return angular.forEach(a,function(e,r){"marker-fill"===e.cssVal&&(t[r]=e.description)}),t},n.getSizeByFields=function(){var t={};return angular.forEach(a,function(e,r){"marker-width"===e.cssVal&&(t[r]=e.description)}),t},n.getColor=function(t,e){if(!(t in a))return"sector"===t?e in r?r[e]:r.Other:(console.error("Have no CSS defined for field: "+t),"#ddd");for(var o=a[t].bins,n=o.length-1,i=n;i-- >0;)if(e<=Number(o[i].max))return o[i].markerVal;return console.error("Could not find a bin for field: "+t+" with value: "+e),o[n].markerVal};var i=function(t){if(!(t in a))return console.error("Field "+t+" has no CartoCSS defined!"),{};var e=a[t].bins,r=e.length-1,o={};if(o.title=a[t].description,"marker-fill"===a[t].cssVal){o.type="choropleth",o.right=e[0].max,o.left=e[r].max,"year_built"!==t&&(o.right=Number(o.right).toLocaleString(),o.left=Number(o.left).toLocaleString()),o.colors=[];for(var n=r;n-- >0;)o.colors.push(e[n].markerVal)}else o.type="bubble",o.color="DarkGrey",o.min=Number(e[r].max).toLocaleString(),o.max=Number(e[0].max).toLocaleString();return o};n.getLegend=function(t){var e=null;if("sector"===t)e=new cartodb.geo.ui.Legend.Custom({title:"Building Type",type:"custom",data:l()});else{var r=i(t);e="bubble"===r.type?new cartodb.geo.ui.Legend.Bubble(r):new cartodb.geo.ui.Legend.Choropleth(r)}return e.render().el};var l=function(){var t=[];return angular.forEach(r,function(e,r){t.push({name:r,value:e})}),t.sort(o)};n.findSectorColor=function(t){return t in r?r[t]:r.Other},n.getFieldCartoCSS=function(r){if("sector"===r)return s();if(!(r in a))return console.error("Field "+r+" has no CartoCSS defined!"),"";for(var o=a[r].bins,n=a[r].cssVal,i=o.length,l="",c="#"+e.getTableName(),u=-1!==t.timeIndependentFields.indexOf(r)?r:r+"_"+e.getCurrentYear(),d=0;d<i;d++){var m=o[d];l+=c+" ["+u+" <= "+m.max+"] {"+n+": "+m.markerVal+";}\n"}return"marker-width"===n&&(l+=c+" ["+u+" = null] {marker-width: 0;}\n"+c+" ["+u+" = 0] {marker-width: 0;}\n"),l};var s=function(){var t="",a="#"+e.getTableName();return angular.forEach(r,function(e,r){t+=a+'[sector="'+r+'"] {marker-fill: '+e+";} "}),t};return n.baseCartoCSS=["#"+e.getTableName()+"{","marker-fill-opacity: 0.8;","marker-line-color: #FFF;","marker-line-width: 0.5;","marker-line-opacity: 1;","marker-placement: point;","marker-multi-policy: largest;","marker-type: ellipse;","marker-fill: #FF5C00;","marker-allow-overlap: true;","marker-clip: false;}"].join(["\n"]),n}t.$inject=["CartoConfig","CartoSQLAPI","MOSColors","MOSCSSValues"],angular.module("mos.colors").factory("ColorService",t)}(),function(){"use strict";angular.module("mos.years",["ui.router"])}(),function(){"use strict";function t(t,e,r,a){var o=this;o.currentYear=a.getCurrentYear(),o.years=a.years,o.updateYear=function(e){t.search("year",e),o.currentYear=a.getCurrentYear()},e.$on("mos.cartodb:years",function(t,e){o.years=e,o.currentYear=a.getCurrentYear()})}t.$inject=["$location","$scope","$window","CartoSQLAPI"],angular.module("mos.years").controller("YearSelectorController",t)}(),function(){"use strict";angular.module("mos.years").directive("mosYearSelector",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/years/year-selector-partial.html",bindToController:!0,controller:"YearSelectorController",controllerAs:"ctl"}})}(),function(){"use strict";function t(t,e){var r=this;r.years=e.allYears,r.yearsData=e.yearsData(),t.$on("mos.cartodb:years",function(){r.years=e.allYears,r.yearsData=e.yearsData()})}t.$inject=["$scope","CartoSQLAPI"],angular.module("mos.years").controller("DataDownloadController",t)}(),function(){"use strict";angular.module("mos.years").directive("mosDataDownload",function(){return{replace:!0,restrict:"AE",scope:{},templateUrl:"scripts/years/data-download-partial.html",bindToController:!0,controller:"DataDownloadController",controllerAs:"ctl"}})}(),function(){"use strict";angular.module("mos.charting",["ngSanitize","mos.colors"])}(),function(){"use strict";angular.module("mos.charting").factory("ChartingUtils",function(){var t={};return t.seed=function(t,e,r){t=void 0===t?50:t,e=void 0===e?100:e,r=void 0===r?1:r;for(var a=function(){return Math.round(Math.random()*e)},o=[],n=0;n<t;n++){var i=null;if(1===r)i=a();else{i=[];for(var l=0;l<r;l++)i[l]=a()}o[n]=i}return o},t})}(),function(){"use strict";function t(t,e,r,a){function o(e){var r=t.$eval(e)||n;return"object"!=typeof r&&(r={left:r,top:r,bottom:r,right:r}),r}var n={left:30,top:10,bottom:30,right:10};t.config={},t.setDefaultMargins=function(t){n=t},t.configure=function(r){angular.forEach(r,function(r,a){var o=e[a];t.config[a]=angular.isDefined(o)?t.$eval(o):r}),t.config.margin=o(e.margin),t.plotComplete=!1},t.redraw=function(e){!e||t.plotComplete||t.config.lazyLoad&&!a.inViewPort(r)||(t.plot(e),t.allowRedraw||(t.plotComplete=!0))},t.plot=function(){},t.$watch("data",function(e){t.redraw(e)}),a.onPanelSnap(r,function(){t.redraw(t.data)})}t.$inject=["$scope","$attrs","$element","Utils"],angular.module("mos.charting").controller("ChartingController",t)}(),function(){"use strict";function t(t,e){function r(t,e){t=_.reject(t,function(t){return!t.sqfeet||t.yearbuilt>n||"3634188"===t.id||"2436917"===t.id}),_.forEach(t,function(t){t.log=Math.log(t.sqfeet)/Math.log(10)});for(var r={},a=_.max(t,function(t){return t.log}).log/e,o=0;o<e;o++)r[o]=_.filter(t,function(t){return a*o<t.log&&a*o+a>=t.log});var i=[];return _.forEach(r,function(t,e){var r=t.length,o=_.filter(t,function(t){return!isNaN(t.energystar)&&t.energystar>0}).length,n=_.filter(t,function(t){return!isNaN(t.eui)&&t.eui>0}).length,l=Math.round(Math.pow(10,e*a)),s=Math.round(Math.pow(10,e*a+a));if(t&&t.length>0){var c=_.minBy(t,function(t){return t.sqfeet}).sqfeet,u=_.maxBy(t,function(t){return t.sqfeet}).sqfeet;i=i.concat({totalemissions:_.reduce(t,function(t,e){return e.emissions+t},0),avgenergystar:o>0?_.reduce(t,function(t,e){return e.energystar+t},0)/o:0,avgeui:n>0?_.reduce(t,function(t,e){return e.eui+t},0)/n:0,minsqft:c||0,maxsqft:u||0,avgsqft:_.reduce(t,function(t,e){return e.sqfeet+t},0)/r,totalsqft:_.reduce(t,function(t,e){return e.sqfeet+t},0),totalenergy:_.reduce(t,function(t,e){return e.sqfeet*e.eui+t},0),count:r,key:l.toLocaleString()+" - "+s.toLocaleString(),yearRange:_.minBy(t,function(t){return t.yearbuilt}).yearbuilt+"-"+_.maxBy(t,function(t){return t.yearbuilt}).yearbuilt,lowBound:l,highBound:s})}}),_.tail(i,function(t){return t.lowBound<800}).reverse()}function a(t){var e=_.reject(t,function(t){return t.yearbuilt<=1849||t.yearbuilt>n||"3634188"===t.id||"2436917"===t.id}),r=_.zip(_.range(1849,2015,5),_.range(1853,2019,5)),a=d3.nest().key(function(t){var e=_.find(r,function(e){return e[0]<=t.yearbuilt&&t.yearbuilt<=e[1]});return e[0]+" - "+e[1]}).rollup(function(t){return{totalsqft:d3.mean(t,function(t){return t.sqfeet}),avgeui:d3.mean(t,function(t){return t.eui}),totalemissions:d3.mean(t,function(t){return t.emissions}),avgenergystar:d3.mean(t,function(t){return t.energystar}),count:d3.sum(t,function(){return 1}),totalenergy:d3.sum(t,function(t){return t.eui*t.sqfeet})}}).entries(e);return _.chain(a).sortBy(function(t){return t.key}).map(function(t){var e=t.values;return e.key=t.key,e.avgenergystar=isNaN(e.avgenergystar)?0:e.avgenergystar,e}).reverse().value()}var o={},n=t.getCurrentYear();return o.restrict="EA",o.templateUrl="scripts/charting/barchart-partial.html",o.controller="ChartingController",o.scope={data:"=",id:"@",plotWidth:"@",selectedY:"=",selectLabel:"=",selectUnit:"=",plotHeight:"@",margin:"&",binType:"@",lazyLoad:"@",transitionMillis:"@"},o.link=function(t,o,i){var l=function(t){return(t+"").split("").map(function(t){return"⁰¹²³⁴⁵⁶⁷⁸⁹"[t]}).join("")};t.configure(e);var s=t.config;s.margin.left=0,s.margin.bottom=40,o.addClass("mos-barchart");var c=d3.select("#"+i.id+" .chart").attr("width",s.plotWidth).attr("height",s.plotHeight);t.plot=function(e){function o(){p.domain([0,d3.max(e,function(t){return t[u]})])}function i(){var t=s.transitionMillis;o(),c.selectAll("rect").transition().ease("linear").duration(t).attr("class",s.binType).attr("y",function(t){return(isNaN(t[u])?0:p(t[u]))-10+s.margin.top}).attr("height",function(t){var e=isNaN(t[u])?0:p(t[u]);return s.plotHeight-e-s.margin.top-s.margin.bottom})}var u=t.selectedY;c.attr("height",s.plotHeight),"temporal"===s.binType?e=a(e):"area"===s.binType&&(e=r(e,62));var d,m=d3.scale.ordinal().domain(e.map(function(t){return t.key})).rangeRoundBands([s.plotWidth-s.margin.left-s.margin.right,0],.05);d="area"===s.binType?d3.scale.log().domain([e[e.length-1].lowBound,e[0].highBound]).range([0,s.plotWidth-s.margin.left-s.margin.right]):m;var p=d3.scale.linear().domain([0,d3.max(e,function(t){return t[u]})]).range([s.plotHeight-s.margin.bottom-s.margin.top,0]),g=d3.svg.axis().orient("bottom").scale(d).tickSize(3,1).ticks(5,function(t){return 10+l(Math.round(Math.log(t)/Math.LN10))});"area"!==s.binType&&(g=g.tickValues([])),c.append("g").attr("class","x axis").attr("transform","translate("+s.margin.left+","+(s.plotHeight-s.margin.bottom)+")").call(g);var f=c.append("text").attr("class","x startLabel").attr("x",s.margin.left).attr("y",s.plotHeight-s.margin.top),h=c.append("text").attr("class","x endLabel").attr("x",s.plotWidth-s.margin.right).attr("y",s.plotHeight-s.margin.top),y=c.append("text").attr("class","x centerLabel").attr("x",(s.plotWidth-s.margin.right)/2).attr("y",s.plotHeight-s.margin.top);"temporal"===s.binType?(f.attr("dy","-10px").text("1850"),h.attr("dy","-10px").text(n),y.attr("dy","-10px").text("Year Built")):"area"===s.binType&&y.text("Sq. Feet ").append("tspan").attr("class","faded").text("(log scale)");var b=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(e){return'<div class="propertyName">'+(e.key+("area"===s.binType?" Sq Ft":""))+'</div><br /><div class="propertyName">'+t.selectLabel+':</div><div class="propertyName">'+Math.round(e[u]).toLocaleString()+" "+t.selectUnit+"</div>"});c.call(b),c.selectAll("bar").data(e).enter().append("rect").attr("transform",function(t){return"translate("+(m(t.key)+s.margin.left).toString()+",0)"}).attr("y",s.plotHeight-s.margin.bottom).attr("height",0).attr("width",m.rangeBand()).attr("opacity",function(t,r){return 1-r/e.length*.3}).attr("rx",3).attr("ry",3).on("mouseover",b.show).on("mouseout",b.hide),i(),t.$watch("selectedY",function(t){u=t,i()})}},o}t.$inject=["CartoSQLAPI","BarChartDefaults"];var e={plotWidth:700,plotHeight:200,transitionMillis:500,lazyLoad:!0,binType:"temporal"};angular.module("mos.charting").constant("BarChartDefaults",e).directive("mosBarchart",t)}(),function(){"use strict";function t(t,e,r){var a=null,o=null,n=null,i={};return i.restrict="EA",i.templateUrl="scripts/charting/bubblechart-partial.html",i.controller="ChartingController",i.scope={data:"=",id:"@",plotWidth:"@",plotHeight:"@",bubblePadding:"@",lazyLoad:"@",transitionTime:"@"},i.link=function(e,i,l){e.SELECT_CLASS="mos-bubblechart-select",e.configure(t);var s=e.config;e.bubbleSeries="count",e.selectOptions={count:"Building Count",totalenergy:"Total Energy (kBtu)",emissions:"Total Emissions (MtCO2e)",energystar:"Mean Energy Star"},i.addClass("mos-bubblechart"),a=d3.select("#"+l.id+" .chart").attr("width",s.plotWidth).attr("height",s.plotHeight),o=d3.layout.pack().size([s.plotWidth,s.plotHeight]).padding(s.bubblePadding),n=d3.tip().attr("class","d3-tip").offset([-10,0]),a.call(n),e.changeSeries=function(t){e.bubbleSeries=t},e.$watch("bubbleSeries",function(){e.plotComplete=!1,e.redraw(e.data)}),e.plot=function(t){var i,l=e.bubbleSeries;if(l){n.html(function(t){return"<div>"+t.name+"</div><div>"+e.selectOptions[l]+": "+Math.round(t[l]).toLocaleString()+"</div>"}),o.sort(null).value(function(t){return t[l]||0});var c=(i=a.selectAll("g").data(o.nodes({children:t}))).enter().append("g").filter(function(t){return 1===t.depth}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).on("mouseover",n.show).on("mouseout",n.hide);c.append("circle").attr("r",0).attr("class","bubble").style("fill",function(t){return r[t.name]||r.Other}),c.append("text").attr("dy",".35em").attr("text-anchor","middle").text(function(t){return t.name}).style("opacity",0),c.append("circle").attr("r",0).attr("class","bubble2").style("opacity",0),i.transition().duration(s.transitionTime).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).selectAll("circle").attr("r",function(t){return t.r}),i.select("text").transition().duration(s.transitionTime).style("opacity",function(t){return this.getBBox().width<2*t.r-5?1:0})}}},i}t.$inject=["BubbleChartDefaults","CartoConfig","MOSColors"];var e={plotWidth:500,plotHeight:400,bubblePadding:25,lazyLoad:!0,transitionTime:500};angular.module("mos.charting").constant("BubbleChartDefaults",e).directive("mosBubblechart",t)}(),function(){"use strict";function t(t,e){var r=null,a=null,o=null,n={};return n.restrict="EA",n.templateUrl="scripts/charting/scatterplot-partial.html",n.controller="ChartingController",n.scope={data:"=",id:"@",plotWidth:"@",plotHeight:"@",pointFillColor:"@",pointStrokeColor:"@",xDefaultDim:"@",yDefaultDim:"@",areaDefaultDim:"@",colorDefaultDim:"@",minRadius:"@",maxRadius:"@",lazyLoad:"@",margin:"&"},n.link=function(n,i,l){n.configure(e);var s=n.config;n.axisOptions=t.getSizeByFields(),n.colorOptions=t.getColorByFields(),n.selected={x:s.xDefaultDim,y:s.yDefaultDim,color:s.colorDefaultDim,area:s.areaDefaultDim},n.changeSelectedOption=function(t,e){n.selected[t]=e,n.plotComplete=!1,n.redraw(n.data)},i.addClass("mos-scatterplot"),r=d3.select("#"+l.id+" .chart").attr("width",s.plotWidth).attr("height",s.plotHeight);var c=function(){$("div.cartodb-legend.choropleth").remove(),$("div.cartodb-legend.custom").remove();var e=$("#scatterplot");$(e).append(t.getLegend(n.selected.color))};n.plot=function(e){var i=n.selected.x,l=n.selected.y,u=n.selected.area,d=n.selected.color,m={x:n.axisOptions[i],y:n.axisOptions[l],area:n.axisOptions[u],color:n.colorOptions[d]},p=function(t){return t[i]<1?1:t[i]},g=function(t){return t[l]<1?1:t[l]},f=function(t){return t[i]<1||t[l]<1?0:Math.sqrt(t[u]/Math.PI)},h=d3.scale.log().domain([1,d3.max(e,p)]).range([s.margin.left,s.plotWidth-s.margin.right]),y=d3.scale.log().domain([1,d3.max(e,g)]).range([s.plotHeight-s.margin.bottom,s.margin.top]),b=d3.scale.linear().domain([0,d3.max(e,f)]).range([s.minRadius,s.maxRadius]);a=d3.svg.axis().orient("left").scale(y).tickValues([]),r.append("g").attr("class","y axis").attr("transform","translate("+s.margin.left+",0)").call(a),o=d3.svg.axis().orient("bottom").scale(h).tickValues([]),r.append("g").attr("class","x axis").attr("transform","translate(0, "+(s.plotHeight-s.margin.bottom)+")").call(o);var v=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return['<span><p class="propertyName">',t.property_name,'</p><p class="propertyName">',m.x,": ",t[i]?t[i].toLocaleString():"0",'</p><p class="propertyName">',m.y,": ",t[l]?t[l].toLocaleString():"0",'</p><p class="propertyName">',m.area,": ",t[u]?t[u].toLocaleString():"0",'</p><p class="propertyName">',m.color,": ","year_built"===d?t[d]:t[d].toLocaleString(),"</p></span>"].join("")});r.call(v);var C=r.selectAll("circle").data(e).on("mouseover",v.show).on("mouseout",v.hide);C.enter().append("circle").attr("cx",function(t){return h(p(t))}).attr("cy",function(t){return y(g(t))}).attr("r",0).attr("fill",s.pointFillColor).on("mouseover",v.show).on("mouseout",v.hide),C.exit().remove(),C.transition().duration(2e3).attr("cx",function(t){return h(p(t))}).attr("cy",function(t){return y(g(t))}).attr("fill",function(e){return t.getColor(d,e[d])}).attr("r",function(t){return b(f(t))}),c()}},n}t.$inject=["ColorService","ScatterPlotDefaults"];var e={plotWidth:800,plotHeight:400,pointFillColor:"#14bfd6",pointStrokeColor:"#ddd",xDefaultDim:"site_eui",yDefaultDim:"total_ghg",areaDefaultDim:"electricity",colorDefaultDim:"sector",minRadius:3,maxRadius:10,lazyLoad:!0};angular.module("mos.charting").constant("ScatterPlotDefaults",e).directive("mosScatterplot",t)}(),function(){"use strict";function t(t,e){return function(r){return e.map(function(e){return[e,d3.mean(r,function(r){return t(e-r)})]})}}function e(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function r(r,a,o){var n={};return n.restrict="EA",n.template='<svg class="chart"></svg>',n.controller="ChartingController",n.scope={data:"=",id:"@",plotWidth:"@",plotHeight:"@",plotWidthPercentage:"@",barRadius:"@",valueField:"@",margin:"&",calloutValues:"=",calloutColors:"=",labels:"=",transitionMillis:"@",allowRedraw:"@",lazyLoad:"@"},n.link=function(r,n,i){r.setDefaultMargins(10),r.configure(a);var l=r.config,s=l.margin,c=r.calloutValues,u=r.calloutColors,d=r.labels;n.addClass("mos-histogram");var m=i.id;m||(m="mos-histogram-"+Math.floor(1000000001*Math.random()).toString(),n.attr("id",m));var p=d3.select("#"+m+" .chart").attr("width",l.plotWidth).attr("height",l.plotHeight).append("g").attr("transform","translate("+s.left+","+s.top+")");r.$watch("calloutValues",function(t){c=t,r.redraw(r.data)}),r.plot=function(r){d3.selectAll("#"+m+" .chart > g > *").remove(),r=_.chain(r).filter(function(t){return t[l.valueField]>=1}).map(function(t){return Math.log(t[l.valueField])/Math.log(10)}).value();var a=_.max(r),n=_.min(r),i=l.plotHeight-s.top-s.bottom,g=l.plotWidth-s.left-s.right,f=d3.scale.linear().domain([n,a]).range([0,g]),h=d3.scale.linear().domain([0,1]).range([i,30]),y=t(e(.3),f.ticks(100))(r),b=d3.svg.area().x(function(t){return f(t[0])}).y0(i).y1(function(t){return h(t[1])});p.append("path").datum(y).attr("class","kde plot").attr("d",b);var v=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){for(var e="<span>",r=0;r<c.length;r++){var a=c[r];e+=["<p ",u[r]?'style="color:'+u[r]+';"':'"',a===t?' class="underline"':"",">",d[r],": ",o("cartodbNumber")(a,0),"</p>"].join("")}return e+="</span>"});p.call(v);for(var C=0;C<c.length;C++)if(null!==c[C]){var x=f(c[C]>=1?Math.log(c[C])/Math.log(10):n);p.append("rect").attr("x",x).attr("y",0).attr("height",i).attr("width","2px").attr("fill",u[C]||"DarkGray")}p.selectAll("rect").data(c).on("mouseover",v.show).on("mouseout",v.hide)}},n}r.$inject=["CartoConfig","HistogramDefaults","$filter"];var a={plotWidth:200,plotHeight:80,plotWidthPercentage:.8,barRadius:4,valueField:"",transitionMillis:500,lazyLoad:!1};angular.module("mos.charting").constant("HistogramDefaults",a).directive("mosHistogram",r)}(),function(){"use strict";angular.module("mos.compare",["ngCookies"])}(),function(){"use strict";function t(t){var e="mos.compare.buildingcompare.compareids",r=t.get(e)||[],a={};return a.add=function(a){"string"==typeof a&&-1===_.indexOf(r,a)&&(r.push(a),t.put(e,r))},a.remove=function(a){if("string"!=typeof a)return null;var o=_.indexOf(r,a),n=null;return-1!==o&&(n=r.splice(o,1),t.put(e,r)),n},a.hasId=function(t){return-1!==_.indexOf(r,t)},a.list=function(){return r},a.count=function(){return r.length},a.clear=function(){r=[],t.remove(e)},a}t.$inject=["$cookieStore"],angular.module("mos.compare").factory("BuildingCompare",t)}(),function(){"use strict";angular.module("mos.mapping",["mos.cartodb","mos.colors"])}(),function(){"use strict";function t(t,e,r,a,o){var n="-75.699037,40.195219,-74.886736,39.774326",i=[],l={};l.FILTER_NONE="All types";var s=o.getTableName(),c=function(t){return _.filter(i,function(e){return-1!==e.indexOf(t)})};return l.getBldgCategories=function(){return new cartodb.SQL({user:a.user}).execute("SELECT DISTINCT sector FROM {{tbl}} order by sector;",{tbl:s})},l.featureLookup=function(t){return new cartodb.SQL({user:a.user}).execute("SELECT * FROM {{tbl}} where cartodb_id = {{id}}",{id:t,tbl:s})},l.featureLookupByBldgId=function(t){return new cartodb.SQL({user:a.user}).execute("SELECT * FROM {{tbl}} where phl_bldg_id = '{{bldgId}}';",{bldgId:t,tbl:s})},l.getBuildingIds=function(){return new cartodb.SQL({user:a.user}).execute("SELECT DISTINCT phl_bldg_id FROM {{tbl}};",{tbl:s})},l.filterViz=function(t,e){t?e===l.FILTER_NONE?t.setSQL("SELECT * FROM "+s+";"):t.setSQL("SELECT * FROM "+s+" WHERE sector ='"+e+"';"):console.error("cannot filter; there is no viz!")},l.setVizCartoCSS=function(t,e,a){if(t){var o=r.baseCartoCSS+" "+r.getFieldCartoCSS(e)+" "+r.getFieldCartoCSS(a);t.setCartoCSS(o)}else console.error("cannot change CartoCSS; there is no viz!")},l.geocode=function(r){var a=e.defer();return t.get("http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates",{params:{singleLine:r,searchExtent:n,category:"Address,Postal",outFields:"StAddr,City,Postal",maxLocations:1,f:"pjson"}}).then(function(t){a.resolve(t.data.candidates)},function(){a.resolve([])}),a.promise},l.suggest=function(e){return t.get("http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/suggest",{params:{text:e,searchExtent:n,category:"Address,Postal",f:"pjson"}}).then(function(t){return c(e).slice(0,5).concat(_.map(t.data.suggestions,"text"))},function(){return c(e).slice(0,5)})},l.getBuildingIds().done(function(t){i=_.map(t.rows,"phl_bldg_id")}),l}t.$inject=["$http","$q","ColorService","CartoConfig","CartoSQLAPI"],angular.module("mos.mapping").factory("MappingService",t)}(),function(){"use strict";function t(t){t.state("charts",{parent:"root",url:"/?year",templateUrl:"scripts/views/charts/charts-partial.html",controller:"ChartsController"})}t.$inject=["$stateProvider"],angular.module("mos.views.charts",["ui.router","mos.cartodb","mos.root","mos.charting","mos.utils"]).config(t)}(),function(){"use strict";angular.module("mos.charting").directive("mosPanelSnap",function(){var t={};return t.restrict="A",t.link=function(t,e,r){e.panelSnap(),e.find("[mos-panel-snap-next]").click(function(t){t.preventDefault(),t.stopPropagation(),e.panelSnap("snapTo","next")}),function(){var r=$(".header")[0],a={offset:120,scroller:e[0],onTop:function(){t.$broadcast("header:on-top")},onNotTop:function(){t.$broadcast("header:on-not-top")}};"undefined"!=typeof Headroom&&new Headroom(r,a).init()}()},t})}(),function(){"use strict";function t(t){var e={};return e.scope={page:"@"},e.restrict="EA",e.templateUrl="scripts/views/charts/charts-glossary-partial.html",e.link=function(t,e,r){"charts"===t.page&&(e.hide(),t.$on("header:on-not-top",function(t){e.show()}),t.$on("header:on-top",function(t){e.hide()}))},e}t.$inject=["Utils"],angular.module("mos.charting").directive("mosChartsGlossary",t)}(),function(){"use strict";function t(t,e){var r={};return r.restrict="A",r.link=function(r,a,o){var n=0,i=0,l=parseInt(o.mosCountUp,10),s=1e3*parseFloat(o.seconds||1),c=Math.ceil(s/30),u=l/c,d=null;e.onPanelSnap(a,function(){!d&&e.inViewPort(a)&&m()});var m=function(){d=t(function(){n+=u,++i>=c?(t.cancel(d),n=l,a[0].textContent=n.toLocaleString()):(a[0].textContent=Math.round(n).toLocaleString(),m())},30)}},r}t.$inject=["$timeout","Utils"],angular.module("mos.charting").directive("mosCountUp",t)}(),function(){"use strict";angular.module("mos.charting").directive("mosBarview",function(){var t={};return t.restrict="EA",t.templateUrl="scripts/views/charts/barview-partial.html",t.scope={data:"="},t.link=function(t){t.selectOptions={count:"Building Count",totalenergy:"Total Energy (kBtu)",totalemissions:"Total Emissions (MtCO2e)",avgenergystar:"Mean Energy Star"};var e={totalenergy:"BTUs",totalemissions:"",avgenergystar:"",count:""};t.selectedY="totalenergy",t.selectLabel=t.selectOptions[t.selectedY],t.selectUnit=e[t.selectedY],t.$watch("selectedY",function(r){t.selectLabel=t.selectOptions[r],t.selectUnit=e[r]}),t.selectedYChanged=function(e){t.selectedY=e}},t})}(),function(){"use strict";function t(t,r,a,o){t.loadingView=!0,t.currentData=[],t.currentAllData=[],t.groupedData=[],t.hideCallout=r.get(e)||!1,t.calloutClicked=function(){r.put(e,!0),t.hideCallout=!0};!function(){t.dataYear=o.getCurrentYear(),t.reportYear=t.dataYear+1,t.stats=o.yearsData()[t.dataYear];var e=o.getAllCurrentData().then(function(e){t.currentAllData=e.data.rows}),r=o.getGroupedData().then(function(e){t.groupedData=e.data.rows});a.all([e,r]).then(function(){t.currentData=o.getCurrentData(t.currentAllData),t.loadingView=!1})}()}t.$inject=["$scope","$cookieStore","$q","CartoSQLAPI"];var e="mos.charts.slideCallout.hide";angular.module("mos.views.charts").controller("ChartsController",t)}(),function(){"use strict";function t(t){t.state("map",{parent:"root",url:"/map?year",templateUrl:"scripts/views/map/map-partial.html",controller:"MapController",resolve:{infoData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getInfoData().then(function(t){return r.getInfo(t.data.rows)})}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.map",["ngSanitize","ui.router","ui.bootstrap","mos.cartodb","mos.root","mos.compare","mos.colors","mos.mapping"]).config(t)}(),function(){"use strict";function t(t,e,r,a,o,n,i,l,s,c,u,d,m){r.mapLoading=!0;r.loadingView=!1;var p=null,g=null;r.getYear=s.getCurrentYear,r.years=s.years.slice(0,2).sort(),r.popupLoading=!0,r.compare={count:i.count(),isChecked:!1,disabled:!1},r.buildingTypes=[],r.filterType=u.FILTER_NONE,r.searchText="",r.noResults=!1,r.amSearching=!1,r.colorByTypes=c.getColorByFields(),r.sizeByTypes=c.getSizeByFields(),r.selections={colorType:"sector",sizeType:"site_eui",filterType:u.FILTER_NONE};var f=function(t){t?(r.propertyData={cartodbId:t.cartodb_id.toString(),buildingId:t.phl_bldg_id,propertyName:t.property_name,floorArea:t.floor_area,address:t.address,sector:t.sector},angular.forEach(r.years,function(e){r.propertyData["totalGhg"+e]=t["total_ghg_"+e],r.propertyData["siteEui"+e]=t["site_eui_"+e],r.propertyData["energyStar"+e]=t["energy_star_"+e]}),r.propertyData.sectorColor=c.findSectorColor(r.propertyData.sector)):r.propertyData={cartodbId:"",buildingId:"",propertyName:"",address:"",floorArea:"",totalGhg:"",siteEui:"",energyStar:"",sector:"",sectorColor:"transparent"}};f(null),r.clearErrorMsg=function(){r.noResults=!1,r.amSearching=!1},r.suggest=function(){r.noResults=!1,r.amSearching=!0;var t=e.defer();return u.suggest(r.searchText).then(function(e){e.length||(r.noResults=!0),t.resolve(e)},function(){r.noResults=!0,t.resolve([])}).finally(function(){r.amSearching=!1}),t.promise},r.searchMap=function(){if(r.amSearching=!0,!r.searchText||r.searchText.length<5)return r.noResults=!0,void(r.amSearching=!1);isNaN(r.searchText)?u.geocode(r.searchText).then(function(e){if(!e.length)return console.error("Could not find address!"),r.noResults=!0,void(r.amSearching=!1);var a=e[0],o=a.location,n=L.latLng(o.y,o.x);g.setView(n,16),r.noResults=!1,r.amSearching=!1;var i=['<span class="featurePopup"><div class="headerPopup geocodePopup"></div>','<div class="popupContent"><p>{{::geocodedDisplayName}}</p></div></span>'].join(""),l=a.attributes;r.geocodedDisplayName=[l.StAddr,l.City,l.Postal].join(", ");var s=t(i)(r);L.popup({minWidth:200}).setLatLng(n).setContent(s[0]).openOn(g)},function(t){console.error(t),r.amSearching=!1,r.noResults=!0}):u.featureLookupByBldgId(r.searchText).done(function(t){if(!t.rows||t.rows.length<1)return r.noResults=!0,void(r.amSearching=!1);var e=t.rows[0];f(e);var a=L.latLng(e.y_coord,e.x_coord);g.setView(a,16),r.popupLoading=!1,r.amSearching=!1,y(a)}).error(function(t){console.error("errors fetching property by building ID: "+t),f(null),r.popupLoading=!1,r.amSearching=!1,r.noResults=!0})},r.filterBy=function(t){r.selections.filterType=t,u.filterViz(p,t)},r.setSelection=function(t,e){r.selections[t]=e,u.setVizCartoCSS(p,r.selections.colorType,r.selections.sizeType),b()},r.setCompare=function(t){i.count()<3&&r.compare.isChecked?i.add(t):r.compare.isChecked||i.remove(t),r.compare.count=i.count()},r.gotoCompare=function(){a.go("compare",{ids:i.list().join(","),year:r.getYear()})};var h=['<span class="featurePopup">','<div ng-show="popupLoading" class="spinner">','<div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>','<div ng-hide="popupLoading"><div class="headerPopup" ',"ng-style=\"{'background-color': '{{::propertyData.sectorColor}}' }\">","<h4>{{::propertyData.propertyName}}</h4>",'<p class="popup-header">OPA Number: {{::propertyData.buildingId}}</p>','<p class="popup-header" ng-if="propertyData.address !== propertyData.propertyName">',"{{::propertyData.address}}</p>",'<p class="popup-header">{{::propertyData.floorArea.toLocaleString()}} sq ft</p></div>','<div class="popupContent">','<div class="row">','<div class="col-sm-5" ng-repeat="year in years">','<h4 class="text-center">{{::year}}</h4><hr />','<p>Site EUI: <strong>{{::propertyData["siteEui" + year]  | cartodbNumber:0}}</strong></p>','<p>Emissions: <strong>{{::propertyData["totalGhg" + year] | cartodbNumber:0}}</strong></p>','<p>Energy Star: <strong>{{::propertyData["energyStar" + year] | cartodbNumber:0}}</strong></p>',"</div>","</div>","<br>",'<p><label><input type="checkbox" ng-model="compare.isChecked" ','ng-disabled="compare.disabled" ','ng-change="setCompare(propertyData.cartodbId)" /> <em>Compare</em></label>','<button type="button" class="pull-right btn btn-popover" ',"ng-style=\"{'background-color': '{{::propertyData.sectorColor}}',  'opacity': 0.8 }\" ",'ui-sref="detail({buildingId: propertyData.cartodbId, year: getYear() })">Full Report</button></p>',"</div></div></span>"].join(""),y=function(e){r.compare.isChecked=i.hasId(r.propertyData.cartodbId),r.compare.disabled=!r.compare.isChecked&&i.count()>=3;var a=t(h)(r);r.$apply(),L.popup({minWidth:380}).setLatLng(e).setContent(a[0]).openOn(g)};u.getBldgCategories().done(function(t){r.buildingTypes=[u.FILTER_NONE],angular.forEach(t.rows,function(t){r.buildingTypes.push(t.sector)})}).error(function(t){console.error("errors fetching property types: "+t),r.buildingTypes=[u.FILTER_NONE]});var b=function(){$("div.cartodb-legend.bubble").remove(),$("div.cartodb-legend.choropleth").remove(),$("div.cartodb-legend.custom").remove(),$("#mymap").append(c.getLegend(r.selections.sizeType)),$("#mymap").append(c.getLegend(r.selections.colorType))};n.onStart({},function(){o(function(){r.loadingView=!0},300)});var v=d.strFormat("https://{user}.carto.com/api/v2/viz/{viz}/viz.json",{user:l.user,viz:m.visualization}),C={infowindow:!1,legends:!1,searchControl:!1,loaderControl:!0,layer_selector:!1};cartodb.createVis("mymap",v,C).done(function(t,e){var a=e[1].getSubLayers();angular.forEach(a,function(t){t.hide()}),r.mapLoading=!1,g=t.getNativeMap();var o=e[1];(p=o.getSubLayer(s.years.indexOf(r.getYear()))).show(),p.setInteraction(!0),p.on("mouseover",function(){$(".leaflet-container").css("cursor","pointer")}),p.on("mouseout",function(){$(".leaflet-container").css("cursor","-webkit-grab"),$(".leaflet-container").css("cursor","-moz-grab")}),b(),p.on("featureClick",function(t,e,a,o){r.popupLoading=!0,y(e),u.featureLookup(o.cartodb_id).done(function(t){var a=t.rows[0];f(a),r.popupLoading=!1,y(e)}).error(function(t){console.error("errors fetching property data: "+t),f(null),r.popupLoading=!1})})})}t.$inject=["$compile","$q","$scope","$state","$timeout","$transitions","BuildingCompare","CartoConfig","CartoSQLAPI","ColorService","MappingService","Utils","infoData"],angular.module("mos.views.map").controller("MapController",t)}(),function(){"use strict";function t(t){t.state("info",{parent:"root",url:"/info?year",templateUrl:"scripts/views/info/info-partial.html",controller:"InfoController",resolve:{infoData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getInfoData().then(function(t){return r.getInfo(t.data.rows)})}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.info",["ui.router","mos.cartodb","mos.root"]).config(t)}(),function(){"use strict";function t(t,e,r){function a(e){if(e&&e.length>1){var r=e.slice().reverse();t.yearsString=[_.dropRight(r,1).join(", "),", and ",_.last(r)].join("")}}t.info=r,t.yearsString="",a(e.years),t.getPrettyUrl=function(t){var e=_.split(t,"//");return e&&e.length>1?e[1]:t},t.$on("mos.cartodb:years",function(t,e){a(e)})}t.$inject=["$scope","CartoSQLAPI","infoData"],angular.module("mos.views.info").controller("InfoController",t)}(),function(){"use strict";function t(t){t.state("detail",{parent:"root",url:"/detail/:buildingId?year",templateUrl:"scripts/views/detail/detail-partial.html",controller:"DetailController",resolve:{buildingData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){return r.setYears(t),r.getBuildingData(e.buildingId)}],currentData:["yearData","CartoSQLAPI",function(t,e){return e.setYears(t),e.getAllCurrentData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.detail",["ui.router","mos.cartodb","mos.root","mos.charting"]).config(t)}(),function(){"use strict";function t(t,e,r,a,o,n,i){var l=n.data&&n.data.rows&&n.data.rows.length>0?n.data.rows[0]:{},s=a[l.sector]||a.Other,c=i.data.rows;t.years=e.years,t.selectedYear=e.getCurrentYear(),t.yearsAscending=e.years.slice().sort(),t.building=l,t.fields=r.fields,t.currentData=c,t.cssValues=o,t.filterField="sector",t.FILTER=r.FILTER,t.dropdownText={},t.dropdownText[r.FILTER.NONE]="All Buildings",t.dropdownText[r.FILTER.SECTOR]="Similar Building Types",t.filterButtonText=t.dropdownText[r.FILTER.NONE],t.headerColor={"background-color":s,opacity:.8},t.filterBy=function(e){e===r.FILTER.SECTOR?t.currentData=_.filter(c,function(t){return t.sector===l.sector}):t.currentData=c,t.filterButtonText=t.dropdownText[e]},t.getCalloutValues=function(e){return _.map(t.years,function(t){return l[e+"_"+t]?l[e+"_"+t]:"N/A"})},t.getCalloutColors=function(){return _.map(t.years,function(e){return e===t.selectedYear?s:""})}}t.$inject=["$scope","CartoSQLAPI","DetailConfig","MOSColors","MOSCSSValues","buildingData","currentData"];var e={fields:["energy_star","site_eui","total_ghg","electricity","natural_gas","fuel_oil","steam","water_use"],FILTER:{NONE:"none",SECTOR:"sector"}};angular.module("mos.views.detail").constant("DetailConfig",e).controller("DetailController",t)}(),function(){"use strict";function t(t){t.state("compare",{parent:"root",url:"/compare?ids?year",templateUrl:"scripts/views/compare/compare-partial.html",controller:"CompareController",resolve:{buildingData:["yearData","$stateParams","CartoSQLAPI",function(t,e,r){r.setYears(t);var a=e.ids.split(",").slice(0,3);return r.getBuildingData(a)}],currentData:["yearData","CartoSQLAPI",function(t,e){return e.setYears(t),e.getAllCurrentData()}]}})}t.$inject=["$stateProvider"],angular.module("mos.views.compare",["ui.router","mos.cartodb","mos.root","mos.compare","mos.charting"]).config(t)}(),function(){"use strict";function t(t,e,r,a,o,n,i,l){var s=a.getCurrentYear(),c=function(t,e){var r={};return angular.forEach(e,function(e){r[e]=[];for(var a=0;a<t.length;a++)r[e].push(t[a][e+"_"+s])}),r};e.year=s,e.buildings=i.data.rows,e.buildingNames=_.map(e.buildings,"property_name"),e.fields=o.fields,e.currentData=l.data.rows,e.cssValues=n,e.calloutColors=["#8FBD84","#81ABCC","#DD8180"],e.calloutValues=c(e.buildings,o.fields),e.close=function(a){var n=e.buildings[a].cartodb_id.toString();r.remove(n),e.buildings.splice(a,1),e.buildingNames.splice(a,1),e.calloutValues=c(e.buildings,o.fields);var i=t.search().ids;if(i){i=i.split(",");var l=_.indexOf(i,n);l>-1&&(i.splice(l,1),t.search("ids",i.join(",")))}}}t.$inject=["$location","$scope","BuildingCompare","CartoSQLAPI","CompareConfig","MOSCSSValues","buildingData","currentData"];var e={fields:["energy_star","site_eui","total_ghg","electricity","natural_gas","fuel_oil","steam","water_use"]};angular.module("mos.views.compare").constant("CompareConfig",e).controller("CompareController",t)}(),function(){"use strict";function t(t){t.otherwise("/")}t.$inject=["$urlRouterProvider"];var e={"School (K-12)":"#A6CEE3",Office:"#1F78B4","Medical Office":"#52A634",Warehouse:"#B2DF8A","College/ University":"#33A02C",Other:"#FB9A99",Retail:"#E31A1C",Municipal:"#FDBF6F",Multifamily:"#FF7F00",Hotel:"#CAB2D6",Industrial:"#6A3D9A",Worship:"#9C90C4",Supermarket:"#E8AE6C",Parking:"#62afe8",Laboratory:"#3AA3FF",Hospital:"#C6B4FF","Data Center":"#a3d895"},r={energy_star:{cssVal:"marker-width",description:"Energy Star",bins:[{max:"100",markerVal:25},{max:"90",markerVal:23.3},{max:"80",markerVal:21.7},{max:"70",markerVal:20},{max:"60",markerVal:18.3},{max:"51",markerVal:16.7},{max:"41",markerVal:15},{max:"31",markerVal:13.3},{max:"21",markerVal:11.7},{max:"11",markerVal:10}]},floor_area:{cssVal:"marker-fill",description:"Square Footage",bins:[{max:"13000000",markerVal:"#91003F"},{max:"405095",markerVal:"#CE1256"},{max:"212892",markerVal:"#E7298A"},{max:"135825",markerVal:"#DF65B0"},{max:"98679",markerVal:"#C994C7"},{max:"75318",markerVal:"#D4B9DA"},{max:"59200",markerVal:"#F1EEF6"}]},year_built:{cssVal:"marker-fill",description:"Year Built",bins:[{max:"2014",markerVal:"#0C2C84"},{max:"1993",markerVal:"#225EA8"},{max:"1972",markerVal:"#1D91C0"},{max:"1952",markerVal:"#41B6C4"},{max:"1932",markerVal:"#7FCDBB"},{max:"1912",markerVal:"#C7E9B4"},{max:"1889",markerVal:"#FFFFCC"}]},site_eui:{cssVal:"marker-width",description:"EUI (kBtu/ft&sup2;)",bins:[{max:"2523",markerVal:"25.0"},{max:"240.4",markerVal:"23.3"},{max:"159.9",markerVal:"21.7"},{max:"119.8",markerVal:"20.0"},{max:"99.3",markerVal:"18.3"},{max:"83.3",markerVal:"16.7"},{max:"69.5",markerVal:"15.0"},{max:"55.9",markerVal:"13.3"},{max:"39.7",markerVal:"11.7"},{max:"16.3",markerVal:"10.0"}]},total_ghg:{cssVal:"marker-width",description:"Emissions (MtCO2e)",bins:[{max:"258330",markerVal:"25.0"},{max:"5311.3",markerVal:"23.3"},{max:"2593.9",markerVal:"21.7"},{max:"1671",markerVal:"20.0"},{max:"1129.4",markerVal:"18.3"},{max:"825.7",markerVal:"16.7"},{max:"598.2",markerVal:"15.0"},{max:"429.6",markerVal:"13.3"},{max:"316.5",markerVal:"11.7"},{max:"126.5",markerVal:"10.0"}]},electricity:{cssVal:"marker-width",description:"Electricity (kBtu)",bins:[{max:"1068323130",markerVal:"25.0"},{max:"27948794.1",markerVal:"23.3"},{max:"14378246.5",markerVal:"21.7"},{max:"9657079.1",markerVal:"20.0"},{max:"6267008.1",markerVal:"18.3"},{max:"4535964",markerVal:"16.7"},{max:"2975929.7",markerVal:"15.0"},{max:"2005814.5",markerVal:"13.3"},{max:"1164578",markerVal:"11.7"},{max:"638726.4",markerVal:"10.0"}]},fuel_oil:{cssVal:"marker-width",description:"Fuel Oil (kBtu)",bins:[{max:"35790575",markerVal:"25.0"},{max:"9401723.3",markerVal:"23.3"},{max:"6210505.9",markerVal:"21.7"},{max:"4234237",markerVal:"20.0"},{max:"3741594.1",markerVal:"18.3"},{max:"3355132.4",markerVal:"16.7"},{max:"2418174.1",markerVal:"15.0"},{max:"1690707",markerVal:"13.3"},{max:"847996",markerVal:"11.7"},{max:"175893.5",markerVal:"10.0"}]},natural_gas:{cssVal:"marker-width",description:"Natural Gas (kBtu)",bins:[{max:"1123733030",markerVal:"35.0"},{max:"16996373.8",markerVal:"32.2"},{max:"7030613.2",markerVal:"29.4"},{max:"4607952.6",markerVal:"26.7"},{max:"3306190.9",markerVal:"23.9"},{max:"2201595.2",markerVal:"21.1"},{max:"1386463.6",markerVal:"18.3"},{max:"765205.4",markerVal:"15.6"},{max:"323197.2",markerVal:"12.8"},{max:"115650",markerVal:"10.0"}]},water_use:{cssVal:"marker-width",description:"Water Use (kgal)",bins:[{max:"700949.4",markerVal:"35.0"},{max:"14733.6",markerVal:"32.2"},{max:"7137.9",markerVal:"29.4"},{max:"3943",markerVal:"26.7"},{max:"2349.3",markerVal:"23.9"},{max:"1345",markerVal:"21.1"},{max:"904.9",markerVal:"18.3"},{max:"611.4",markerVal:"15.6"},{max:"328.3",markerVal:"12.8"},{max:"112.7",markerVal:"10.0"}]},steam:{cssVal:"marker-width",description:"Steam (kBtu)",bins:[{max:"1375885588",markerVal:"25.0"},{max:"33787072",markerVal:"23.3"},{max:"20344457.7",markerVal:"21.7"},{max:"14335164",markerVal:"20.0"},{max:"11635695.2",markerVal:"18.3"},{max:"9132222.5",markerVal:"16.7"},{max:"6982731.5",markerVal:"15.0"},{max:"5334792",markerVal:"13.3"},{max:"3599831.1",markerVal:"11.7"},{max:"1982704.8",markerVal:"10.0"}]}};angular.module("mos",["mos.root","mos.headerbar","mos.views.charts","mos.views.map","mos.views.info","mos.views.detail","mos.views.compare","mos.years","headroom"]).config(t),angular.module("mos").constant("MOSColors",e),angular.module("mos").constant("MOSCSSValues",r)}(),function(){"use strict";function t(t){var e={};return e.restrict="A",e.link=function(e,r){t.onStart({},function(){r.addClass("headroom headroom--top"),r.removeClass("headroom--not-top headroom--unpinned headroom--pinned")})},e}t.$inject=["$transitions"],angular.module("mos").directive("headroomReset",t)}();